# Trustless SocialFi 全栈架构文档 / Fullstack Architecture Document

## Table of Contents

- [Trustless SocialFi 全栈架构文档 / Fullstack Architecture Document](#table-of-contents)
  - [介绍 / Introduction](./介绍-introduction.md)
    - [架构核心特性 / Core Architecture Features](./介绍-introduction.md#架构核心特性-core-architecture-features)
    - [技术栈概览 / Technology Stack Overview](./介绍-introduction.md#技术栈概览-technology-stack-overview)
    - [项目类型 / Starter Template or Existing Project](./介绍-introduction.md#项目类型-starter-template-or-existing-project)
    - [变更日志 / Change Log](./介绍-introduction.md#变更日志-change-log)
  - [高层架构 / High Level Architecture](./高层架构-high-level-architecture.md)
    - [技术概要 / Technical Summary](./高层架构-high-level-architecture.md#技术概要-technical-summary)
    - [平台和基础设施选择 / Platform and Infrastructure Choice](./高层架构-high-level-architecture.md#平台和基础设施选择-platform-and-infrastructure-choice)
    - [仓库结构 / Repository Structure](./高层架构-high-level-architecture.md#仓库结构-repository-structure)
  - [技术栈 / Tech Stack](./技术栈-tech-stack.md)
    - [技术栈表格 / Technology Stack Table](./技术栈-tech-stack.md#技术栈表格-technology-stack-table)
  - [数据模型 / Data Models](./数据模型-data-models.md)
    - [用户 / User](./数据模型-data-models.md#用户-user)
    - [帖子 / Post (Content)](./数据模型-data-models.md#帖子-post-content)
    - [Agent / Agent](./数据模型-data-models.md#agent-agent)
  - [API 规范 / API Specification](./api-规范-api-specification.md)
    - [REST API 概览 / REST API Overview](./api-规范-api-specification.md#rest-api-概览-rest-api-overview)
      - [认证 / Authentication](./api-规范-api-specification.md#认证-authentication)
      - [用户 / Users](./api-规范-api-specification.md#用户-users)
      - [帖子 / Posts](./api-规范-api-specification.md#帖子-posts)
      - [Agent](./api-规范-api-specification.md#agent)
      - [IPFS](./api-规范-api-specification.md#ipfs)
  - [组件 / Components](./组件-components.md)
    - [前端组件 / Frontend Components (Next.js)](./组件-components.md#前端组件-frontend-components-nextjs)
    - [后端组件 / Backend Components (Fastify)](./组件-components.md#后端组件-backend-components-fastify)
  - [数据库 Schema / Database Schema](./数据库-schema-database-schema.md)
  - [前端架构 / Frontend Architecture](./前端架构-frontend-architecture.md)
    - [组件架构 / Component Architecture](./前端架构-frontend-architecture.md#组件架构-component-architecture)
    - [状态管理 / State Management](./前端架构-frontend-architecture.md#状态管理-state-management)
    - [路由 / Routing](./前端架构-frontend-architecture.md#路由-routing)
  - [后端架构 / Backend Architecture](./后端架构-backend-architecture.md)
    - [服务架构 / Service Architecture](./后端架构-backend-architecture.md#服务架构-service-architecture)
    - [认证流程 / Authentication Flow](./后端架构-backend-architecture.md#认证流程-authentication-flow)
  - [统一项目结构 / Unified Project Structure](./统一项目结构-unified-project-structure.md)
  - [开发工作流 / Development Workflow](./开发工作流-development-workflow.md)
    - [本地环境设置 / Local Setup](./开发工作流-development-workflow.md#本地环境设置-local-setup)
    - [开发命令 / Development Commands](./开发工作流-development-workflow.md#开发命令-development-commands)
  - [部署架构 / Deployment Architecture](./部署架构-deployment-architecture.md)
    - [部署策略 / Deployment Strategy](./部署架构-deployment-architecture.md#部署策略-deployment-strategy)
    - [环境 / Environments](./部署架构-deployment-architecture.md#环境-environments)
    - [CI/CD 流水线 / CI/CD Pipeline](./部署架构-deployment-architecture.md#cicd-流水线-cicd-pipeline)
  - [安全和性能 / Security and Performance](./安全和性能-security-and-performance.md)
    - [安全要求 / Security Requirements](./安全和性能-security-and-performance.md#安全要求-security-requirements)
    - [性能优化 / Performance Optimization](./安全和性能-security-and-performance.md#性能优化-performance-optimization)
  - [测试策略 / Testing Strategy](./测试策略-testing-strategy.md)
    - [测试金字塔 / Testing Pyramid](./测试策略-testing-strategy.md#测试金字塔-testing-pyramid)
    - [覆盖率要求 / Coverage Requirements](./测试策略-testing-strategy.md#覆盖率要求-coverage-requirements)
    - [测试组织 / Test Organization](./测试策略-testing-strategy.md#测试组织-test-organization)
    - [关键测试示例 / Key Test Examples](./测试策略-testing-strategy.md#关键测试示例-key-test-examples)
  - [编码规范 / Coding Standards](./编码规范-coding-standards.md)
    - [关键全栈规则 / Critical Fullstack Rules](./编码规范-coding-standards.md#关键全栈规则-critical-fullstack-rules)
    - [命名约定 / Naming Conventions](./编码规范-coding-standards.md#命名约定-naming-conventions)
    - [代码风格 / Code Style](./编码规范-coding-standards.md#代码风格-code-style)
  - [错误处理策略 / Error Handling Strategy](./错误处理策略-error-handling-strategy.md)
    - [错误响应格式 / Error Response Format](./错误处理策略-error-handling-strategy.md#错误响应格式-error-response-format)
    - [前端错误处理 / Frontend Error Handling](./错误处理策略-error-handling-strategy.md#前端错误处理-frontend-error-handling)
    - [后端错误处理 / Backend Error Handling](./错误处理策略-error-handling-strategy.md#后端错误处理-backend-error-handling)
    - [智能合约错误 / Smart Contract Errors](./错误处理策略-error-handling-strategy.md#智能合约错误-smart-contract-errors)
  - [监控和可观测性 / Monitoring and Observability](./监控和可观测性-monitoring-and-observability.md)
    - [监控栈 / Monitoring Stack](./监控和可观测性-monitoring-and-observability.md#监控栈-monitoring-stack)
    - [关键指标 / Key Metrics](./监控和可观测性-monitoring-and-observability.md#关键指标-key-metrics)
    - [告警规则 / Alerting](./监控和可观测性-monitoring-and-observability.md#告警规则-alerting)
  - [架构决策记录 / Architecture Decision Records](./架构决策记录-architecture-decision-records.md)
    - [ADR-001: 使用 Turborepo Monorepo / Use Turborepo Monorepo](./架构决策记录-architecture-decision-records.md#adr-001-使用-turborepo-monorepo-use-turborepo-monorepo)
    - [ADR-002: 使用 Fastify 而非 Express / Use Fastify over Express](./架构决策记录-architecture-decision-records.md#adr-002-使用-fastify-而非-express-use-fastify-over-express)
    - [ADR-003: 使用 viem 而非 ethers.js / Use viem over ethers.js](./架构决策记录-architecture-decision-records.md#adr-003-使用-viem-而非-ethersjs-use-viem-over-ethersjs)
    - [ADR-004: 使用 PostgreSQL 而非 MongoDB / PostgreSQL over MongoDB](./架构决策记录-architecture-decision-records.md#adr-004-使用-postgresql-而非-mongodb-postgresql-over-mongodb)
    - [ADR-005: OpenAI API (MVP) → 自托管 LLM (Post-MVP)](./架构决策记录-architecture-decision-records.md#adr-005-openai-api-mvp-自托管-llm-post-mvp)
  - [核心工作流程图 / Core Workflow Diagrams](./核心工作流程图-core-workflow-diagrams.md)
    - [用户发帖完整流程 / Complete Post Creation Flow](./核心工作流程图-core-workflow-diagrams.md#用户发帖完整流程-complete-post-creation-flow)
  - [智能合约详解 / Smart Contract Details](./智能合约详解-smart-contract-details.md)
    - [合约列表 / Contract List](./智能合约详解-smart-contract-details.md#合约列表-contract-list)
    - [合约详细说明 / Detailed Contract Descriptions](./智能合约详解-smart-contract-details.md#合约详细说明-detailed-contract-descriptions)
      - [1. TrustToken.sol - 原生代币合约](./智能合约详解-smart-contract-details.md#1-trusttokensol-原生代币合约)
      - [2. UserRegistry.sol - 用户注册合约](./智能合约详解-smart-contract-details.md#2-userregistrysol-用户注册合约)
      - [3. AgentRegistry.sol - Agent 注册合约](./智能合约详解-smart-contract-details.md#3-agentregistrysol-agent-注册合约)
      - [4. ContentRegistry.sol - 内容注册合约](./智能合约详解-smart-contract-details.md#4-contentregistrysol-内容注册合约)
      - [5. AgentSelector.sol - VRF 随机选择合约](./智能合约详解-smart-contract-details.md#5-agentselectorsol-vrf-随机选择合约)
      - [6. ModerationWorkflow.sol - 审核工作流合约](./智能合约详解-smart-contract-details.md#6-moderationworkflowsol-审核工作流合约)
      - [7. ReputationSystem.sol - 信誉系统合约](./智能合约详解-smart-contract-details.md#7-reputationsystemsol-信誉系统合约)
      - [8. SocialGraph.sol - 社交图谱合约](./智能合约详解-smart-contract-details.md#8-socialgraphsol-社交图谱合约)
      - [9. Governance.sol - DAO 治理合约](./智能合约详解-smart-contract-details.md#9-governancesol-dao-治理合约)
      - [10. ModerationRules.sol - 规则存储合约](./智能合约详解-smart-contract-details.md#10-moderationrulessol-规则存储合约)
  - [检查清单结果 / Checklist Results Report](./检查清单结果-checklist-results-report.md)
  - [附录 / Appendix](./附录-appendix.md)
    - [术语表 / Glossary](./附录-appendix.md#术语表-glossary)
    - [参考资料 / References](./附录-appendix.md#参考资料-references)
    - [联系方式 / Contact](./附录-appendix.md#联系方式-contact)
